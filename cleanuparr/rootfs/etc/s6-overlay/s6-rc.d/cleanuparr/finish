#!/bin/sh

# Capture exit code
if [ "$1" -eq 256 ]; then
  exit_code=$((128 + $2))
else
  exit_code="$1"
fi

# Write exit code for container
echo "${exit_code}" > /run/s6-linux-init-container-results/exitcode

# Log exit reason
if [ "${exit_code}" -ne 0 ]; then
  echo "[ERROR] Cleanuparr exited with code ${exit_code}" >&2
fi

# Exit 0 allows S6 to restart the service
exit 0
