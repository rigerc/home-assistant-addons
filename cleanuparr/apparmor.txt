#include <tunables/global>

profile cleanuparr-addon flags=(attach_disconnected,mediate_deleted) {
  #include <abstractions/base>

  # S6-Overlay
  /init ix,
  /bin/** ix,
  /usr/bin/** ix,
  /command/** ix,
  /package/** ix,
  /run/s6/** rwix,
  /etc/s6-overlay/** rwix,

  # Cleanuparr binary
  /usr/bin/cleanuparr rix,

  # .NET runtime libraries
  /usr/lib/libMono.Unix.so rm,
  /usr/lib/libe_sqlite3.so rm,
  /app/** r,

  # Data directories
  /config/** rw,
  /data/** rw,

  # Network
  network inet stream,
  network inet6 stream,
  network inet dgram,

  # System files
  /etc/passwd r,
  /etc/group r,
  /etc/hosts r,
  /etc/resolv.conf r,
  /etc/ssl/** r,
  /usr/share/ca-certificates/** r,

  # Temporary files
  /tmp/** rw,
}
